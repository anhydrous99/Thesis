\chapter{Environment}\label{ch:environment}

This chapter aggregates the previous information and introduces the Reinforcement Learning environment that simulates an initial circular orbit of a satellite in low earth orbit and an accelerated Orbital Decay. The initial conditions, the dynamics of the system, the action and observation space, a distributed optimization of PPO algorithm's hyper-parameter, an evaluation of PPO within this environment, and an analysis of the resulting PPO agent.

\section{Environment Description}

The dynamics of the environment follows that of the physics of Chapter~\ref{ch:physics}. The base of the environment revolves around Algorithm~\ref{alg:problemsim} using the 4th Order Yoshida integrator to calculate the next step's velocity and position from the previous velocity and position and the state's acceleration calculated from the gravitational force and the amplified Drag. 

One aspect of the Environment not yet described in Chapter~\ref{ch:physics} and Section~\ref{sec:reinforcement_learning} is how the satellite agent interacts with it's environment. The maximum force of propulsion of the satellite is a fraction of that of Ion Thruster at $0.04$ Newtons and, it being in a 2D-world or on a plane in a 3D-world, restricting its angle of thrust to a single degree of freedom with values between 0\si{\degree} and 360\si{\degree}. The agent operates in continuous action space with 2 values between 0 and 1. These two input values are not directly map to $[0, 0.04]$ for thrust and $[0, 360)$ as would be natural, but, to reduce variance, it is instead mapped to a delta of the thrust and angle values. This delta's range is $\frac{1}{50}$th the maximum thrust and $\frac{1}{6}$th the maximum angle. If the resulting value of the thrust after applying it's delta is greater than $0.04$ or less than $0$ it is clipped. On the other hand, the angle is wrapped to be between $-\pi$ and $\pi$ after applying the angle delta. The initial thrust is 0 and the initial thrust angle is normal to the origin. The height of the satellite is 550\si{km} from the surface or a radius of $6.921\times 10^6\si{meters}$. The mass of the satellite is 100\si{kg}, 75\si{kg} of which is propellant. Every step in the environment is equivalent to a second. The more massive object, to resemble earth has the same gravitational parameter, $3.986004418\times 10^{14}\si{m^3s^{-2}}$. The surface area of the satellite normal to the velocity is 1\si{m}, this is used while calculating the drag, while the drag coefficient is set to 2.123. As per Chapter~\ref{ch:physics}, the initial orbital velocity is $$v_{\text{orbital}}=\sqrt{\frac{GM}{r}}$$ where $GM$ is the gravitational parameter and $r$ is the radius from our stationary earth located at the origin. 

To simplify the calculation of the remaining fuel and mass after each step, the satellite is given enough fuel for 125 steps at maximum thrust. A counter is kept that keeps track of the accumulated thrust before the mapping, which has the range $[0, 1]$. This accumulated thrust is then used to calculate if this threshold has been reached and remaining fuel mass.

The observation space is also continuous of size 8. It includes the normalized position with respect to the initial radius, normalized velocity with respect to the initial velocity, the euclidean distance between the satellite and the target orbit, the euclidean distance between the current velocity and the target velocity for the target circular orbit, the current angle, and the current thrust. All of these values are mapped to be between 0 and 1 before returning to them to the RL algorithm.
	
\section{Distributed Hyper-parameter Optimization}

\section{Training \& Evaluation}

\section{Discussion}